<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>T√©moignages | Jean Volcy - D√©veloppeur Web Freelance</title>

    <meta
      name="description"
      content="D√©couvrez les avis clients et t√©moignages de collaborations avec Jean Volcy, d√©veloppeur web freelance."
    />
    <meta
      name="keywords"
      content="Jean Volcy, t√©moignages, recommandations, clients, avis, freelance, d√©veloppeur web"
    />
    <meta name="author" content="Jean Volcy" />
    <link rel="canonical" href="https://www.jeyko.dev/temoignages.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="T√©moignages | Jean Volcy" />
    <meta
      property="og:description"
      content="D√©couvrez les t√©moignages et avis de mes clients."
    />
    <meta property="og:url" content="https://www.jeyko.dev/temoignages.html" />
    <meta
      property="og:image"
      content="https://www.jeyko.dev/img/Jeyko.dev%20logo.png"
    />
    <meta property="og:type" content="website" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="T√©moignages | Jean Volcy" />
    <meta
      name="twitter:description"
      content="Avis clients et partenaires de Jean Volcy, d√©veloppeur web freelance."
    />
    <meta
      name="twitter:image"
      content="https://www.jeyko.dev/img/Jeyko.dev%20logo.png"
    />

    <link rel="icon" type="image/x-icon" href="img/Jeyko.dev logo.png" />
    <link rel="manifest" href="manifest.json" />

    <!-- Feuilles de style -->
    <link rel="stylesheet" href="css/global.css" />
    <link rel="stylesheet" href="css/default.css" />
    <link rel="stylesheet" href="css/portfolio.css" />
    <link rel="stylesheet" href="css/temoignages.css" />
    <link rel="stylesheet" href="css/responsive.css" />
  </head>

  <body>
    <header>
      <div class="container">
        <!-- Logo image -->
        <div class="logo">
          <img src="img/Jeyko.dev logo.png" alt="Logo Jeyko.dev" />
        </div>

        <!-- Bouton hamburger -->
        <button class="hamburger" id="hamburger" aria-label="Menu">
          <span></span>
          <span></span>
          <span></span>
        </button>

        <nav>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li>
              <a href="about.html" aria-current="page">√Ä propos de moi</a>
            </li>
            <li><a href="projects.html">Projets</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="temoignages.html">T√©moignages</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="temoignages-main">
      <!-- Bouton vers formulaire -->
      <div class="avis-button-wrapper">
        <button
          class="avis-button"
          onclick="document.getElementById('avis-form-section').scrollIntoView({ behavior: 'smooth' })"
        >
          ‚ú® Donner aussi votre avis
        </button>
      </div>

      <!-- T√©moignages -->
      <section id="temoignages-section">
        <h2 class="temoignages-title">Ils m'ont fait confiance</h2>
        <div class="temoignage-container">
          <button class="nav-arrow" id="prev-temoignage">‚Äπ</button>
          <div class="temoignage-card" id="temoignage-card"></div>
          <button class="nav-arrow" id="next-temoignage">‚Ä∫</button>
        </div>
        <div class="temoignage-pagination" id="temoignage-pagination"></div>
      </section>

      <!-- √Ä placer entre les sections -->
      <div class="wave-separator">
        <svg viewBox="0 0 1440 100" preserveAspectRatio="none">
          <path d="M0,0 C360,100 1080,0 1440,100 L1440,0 L0,0 Z" fill="#f4efff">
            <animate
              attributeName="d"
              dur="8s"
              repeatCount="indefinite"
              values="
          M0,0 C360,100 1080,0 1440,100 L1440,0 L0,0 Z;
          M0,0 C260,80 1180,20 1440,100 L1440,0 L0,0 Z;
          M0,0 C360,100 1080,0 1440,100 L1440,0 L0,0 Z
        "
            />
          </path>
        </svg>
      </div>

      <!-- Formulaire -->
      <section class="avis-form" id="avis-form-section">
        <div class="avis-form-wrapper">
          <div class="avis-contact-info">
            <h3><i class="fa fa-comments"></i> On Vous lit !</h3>
            <div class="avis-item">
              <i class="fa fa-envelope"></i>
              <div><strong>Email</strong><br />contact.jeyko.dev@gmail.com</div>
            </div>
            <div class="avis-item">
              <i class="fa fa-phone"></i>
              <div><strong>T√©l√©phone</strong><br />+33753148607</div>
            </div>
          </div>
          <form class="avis-form-fields" id="avis-form">
            <div class="form-row full-width">
              <div class="type-toggle">
                <button
                  type="button"
                  class="toggle-option active"
                  data-type="particulier"
                >
                  üôã‚Äç‚ôÇÔ∏è Particulier
                </button>
                <button
                  type="button"
                  class="toggle-option"
                  data-type="entreprise"
                >
                  üè¢ Entreprise
                </button>
              </div>
            </div>
            <input
              type="hidden"
              name="type"
              id="type-field"
              value="particulier"
            />
            <div class="form-row">
              <input
                type="text"
                name="prenom"
                placeholder="Votre pr√©nom..."
                required
              />
              <input
                type="text"
                name="nom"
                placeholder="Votre nom..."
                required
              />
            </div>
            <div class="form-row">
              <div class="entreprise-container">
                <input
                  type="text"
                  name="entreprise"
                  id="entreprise-field"
                  placeholder="Nom de l'entreprise (pro seulement)"
                />
              </div>
              <input
                type="email"
                name="email"
                placeholder="Votre email..."
                required
              />
            </div>
            <textarea
              name="message"
              placeholder="Votre message..."
              rows="5"
              required
            ></textarea>
            <button type="submit">Soumettre</button>
          </form>
        </div>
      </section>

      <!-- Modal -->
      <div id="confirmationModal" class="modal hidden">
        <div class="modal-content">
          <span class="close-btn" id="closeModal">&times;</span>
          <h2>Merci pour votre avis ! üéâ</h2>
          <p>Votre t√©moignage a bien √©t√© enregistr√©.</p>
          <a href="index.html" class="return-home">Retour √† l'accueil</a>
        </div>
      </div>
    </main>
    <script>
      const temoignages = [
        {
          logo: "img/logo1.png",
          message:
            "Jean a su transformer nos id√©es en r√©alit√© avec efficacit√© et pr√©cision.",
          auteur: "Sarah Dupont",
          fonction: "Directrice chez ROC",
        },
        {
          logo: "img/logo2.png",
          message:
            "Un vrai pro ! Le site est rapide, moderne et parfaitement responsive.",
          auteur: "Marc Lef√®vre",
          fonction: "Co fondateur de Mode & Motion",
        },
        {
          logo: "img/logo3.png",
          message:
            "Merci Jean pour ta r√©activit√© et ton √©coute, je recommande √† 100% !",
          auteur: "A√Øssata Kon√©",
          fonction: "Responsable Marketing chez Jeyko Location",
        },
        {
          logo: "img/logo4.png",
          message:
            "Un accompagnement fluide du d√©but √† la fin, avec des livrables impeccables.",
          auteur: "David Morel",
          fonction: "Fondateur de HealthyFood",
        },
      ];

      const card = document.getElementById("temoignage-card");
      const pagination = document.getElementById("temoignage-pagination");
      const prevBtn = document.getElementById("prev-temoignage");
      const nextBtn = document.getElementById("next-temoignage");
      const form = document.getElementById("avis-form");
      const modal = document.getElementById("confirmationModal");
      const closeModal = document.getElementById("closeModal");
      const toggleButtons = document.querySelectorAll(".toggle-option");
      const typeField = document.getElementById("type-field");
      const entrepriseField = document.getElementById("entreprise-field");

      let index = 0;
      let timer;

      function afficherTemoignage(i) {
        const t = temoignages[i];
        card.innerHTML = `
    <img src="${t.logo}" alt="Logo client">
    <p>"${t.message}"</p>
    <div class="auteur">${t.auteur}</div>
    <div class="fonction">${t.fonction}</div>
  `;
        pagination.innerHTML = "";
        temoignages.forEach((_, j) => {
          const dot = document.createElement("span");
          dot.classList.toggle("active", j === i);
          pagination.appendChild(dot);
        });
      }

      function changerTemoignage(sens = 1) {
        index = (index + sens + temoignages.length) % temoignages.length;
        afficherTemoignage(index);
      }

      function boucleAuto() {
        timer = setInterval(() => changerTemoignage(1), 12000);
      }

      prevBtn.addEventListener("click", () => {
        clearInterval(timer);
        changerTemoignage(-1);
        boucleAuto();
      });
      nextBtn.addEventListener("click", () => {
        clearInterval(timer);
        changerTemoignage(1);
        boucleAuto();
      });

      toggleButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          toggleButtons.forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          typeField.value = btn.dataset.type;
          entrepriseField.parentElement.style.display =
            btn.dataset.type === "particulier" ? "none" : "block";
        });
      });

      form?.addEventListener("submit", async function (e) {
        e.preventDefault();

        const formData = new FormData(form);

        const prenom = formData.get("prenom")?.trim() || "";
        const nom = formData.get("nom")?.trim() || "";
        const entreprise = formData.get("entreprise")?.trim() || "";
        const email = formData.get("email")?.trim() || "";
        const type = formData.get("type") || "particulier";
        const message = formData.get("message")?.trim() || "";

        // Construction de l‚Äôobjet conforme √† Mongoose
        const data = {
          nom: prenom + " " + nom,
          fonction: entreprise || "Particulier",
          message,
          note: 5,
          type,
        };
        console.log("Donn√©es envoy√©es :", data);

        try {
          const res = await fetch("http://localhost:5001/api/temoignages", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
          });

          if (res.ok) {
            const responseData = await res.json();
            console.log("R√©ponse serveur :", responseData);

            form.reset();
            typeField.value = "particulier";
            toggleEntrepriseField();
            modal.classList.add("visible");
            setTimeout(() => modal.classList.remove("visible"), 5000);
          } else {
            const err = await res.json();
            console.error("Erreur serveur :", err);
            alert("Erreur lors de l'envoi du formulaire.");
          }
        } catch (err) {
          console.error("Erreur r√©seau :", err);
          alert("Une erreur r√©seau est survenue.");
        }
      });

      closeModal?.addEventListener("click", () =>
        modal.classList.remove("visible")
      );

      window.addEventListener("click", (e) => {
        if (e.target === modal) modal.classList.remove("visible");
      });

      document.addEventListener("DOMContentLoaded", () => {
        afficherTemoignage(index);
        boucleAuto();
        entrepriseField.parentElement.style.display = "none";
      });

      // Menu hamburger
      const hamburger = document.getElementById("hamburger");
      const navMenu = document.getElementById("nav-menu");

      if (hamburger && navMenu) {
        hamburger.addEventListener("click", () => {
          navMenu.classList.toggle("show");
          hamburger.classList.toggle("active");
        });
      }
    </script>
  </body>
</html>
